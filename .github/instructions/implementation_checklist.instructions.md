---
applyTo: '**'
---
# ForkCast Android Development Phases & Copilot Checklists

## Development Phases

### Phase 1: Planning & Requirements Gathering ( Done )
- Define user requirements
- Define system requirements
- Finalize feature list and pages
- Design Firebase schema & data model
- Create UI/UX mockups

### Phase 2: Project Setup & Architecture
- Initialize Flutter project (Android only)
- Set up folder structure:
  - `lib/features/auth/`
  - `lib/features/profile/`
  - `lib/features/meal_planner/`
  - `lib/features/market_price/`
  - `lib/features/qna/`
  - `lib/features/teleconsultation/`
  - `lib/models/`
  - `lib/services/`
  - `lib/widgets/`
- Configure Firebase authentication, Firestore, and storage
- Add dependencies (`firebase_auth`, `cloud_firestore`, `flutter_local_notifications`, etc.)
- Configure linter and project rules (`analysis_options.yaml`)

### Phase 3: Authentication & Profile Management
- Implement login, sign up, forgot password flows
- Implement user profile setup flow
- Connect authentication to Firestore `users` collection
- Handle roles: `user`, `admin`, `professional`

### Phase 4: Core Features Implementation
- [x] BMI Calculator
  - [x] Firebase integration implemented (saves calculated BMI to users.bmi field)
  - [x] User model updated with bmi: number field
- [x] User Dashboard (home page with calorie overview, nutrient breakdown, daily meal plan, weekly progress)
  - [x] Firebase integration implemented (loads real user data)
  - [x] Displays real BMI, user name, and profile data
  - [x] TODO notes added for meal tracking and nutrient calculation features
- Meal Planner & Daily Meal Plan Generator
  - Meal plan CRUD
  - Recipe subcollections
- Meal Page Logging & Nutrition Facts
- Ingredient-based Meal Search & Filtering
- Market Price Dashboard & Forecasting
- Price Alerts & Trends
- Q&A Forum
- Teleconsultation booking & management

### Phase 5: UI/UX Refinement
- Apply Material Design & consistent theming
- Ensure responsive layouts for Android
- Test all pages and navigation flows
- Integrate push notifications & micro-tips

### Phase 6: Testing & Quality Assurance
- Unit tests for models and services
- Widget tests for UI pages
- Integration tests for Firebase interactions
- Bug fixes & performance optimization

### Phase 7: Deployment & Maintenance
- Prepare APK build
- Conduct internal testing
- Release to Google Play Store (optional beta)
- Maintain documentation
- Monitor Firebase analytics & logs

---

## Copilot Implementation Checklist

 - [x] **Auth Features**
   - [x] `splash_screen.dart` (simple splash screen)
   - [x] `get_started_page.dart` (social login options)
   - [x] `sign_in_page.dart` (Firebase Auth, navigation to profile setup)
   - [x] `sign_up_page.dart` (validated)
   - [x] `forgot_password_flow` (OTP → Reset → Confirmation)
     - [x] `forgot_password_page.dart`
     - [x] `otp_code_page.dart`
     - [x] `create_new_password_page.dart`
     - [x] `all_set_page.dart`
 - [x] **Profile Features**
   - [x] Profile setup pages started
     - [x] `name_entry_page.dart` (progress bar, centered input with shadow, navigation from sign in)
     - [x] `gender_selection_page.dart` (progress 2/8, Male/Female/Prefer not to say options with green selection)
     - [x] `birthday_entry_page.dart` (progress 3/8, scrollable date pickers for Month/Day/Year)
     - [x] `height_input_page.dart` (progress 4/8, scrollable ruler with cm/ft toggle and connected input field)
     - [x] `weight_input_page.dart` (progress 5/8, scrollable ruler with kg/lb toggle and connected input field)
  - [x] `weekly_budget_page.dart` (progress 6/8, modern numeric input, +/- controls, custom dialog)
    - [x] Navigate medical conditions → BMI (profile flow navigation wired)
   - [x] `edit_profile_page.dart` (comprehensive profile editing with all Firebase schema fields, modern UI design)
   - [x] **Food Allergies Integration** (Complete implementation)
     - [x] `User` model updated with `foodAllergies` field and Firebase serialization
     - [x] Edit profile page connected to save allergies to Firebase
     - [x] User profile page displays allergies chips in health information section
     - [x] Add/edit allergies dialog functionality implemented
  - [x] Profile connected to Firestore `users` collection
  - [x] **Profile Setup Backend Integration**
    - [x] `User` model class created (`lib/models/user.dart`) with Firebase serialization
    - [x] User model updated with bmi: number field for BMI storage
    - [x] Firebase schema updated to include bmi field in users collection
    - [x] UserService enhanced with profile updates and health conditions management
    - [x] `ProfileSetupProvider` created (`lib/providers/profile_setup_provider.dart`) for state management
    - [x] `UserService` enhanced with profile updates and health conditions management
    - [x] All profile setup pages connected to save data to ProfileSetupProvider
    - [x] Final profile save to Firebase implemented in `medical_conditions_page.dart`
    - [x] Provider integration added to main.dart with MultiProvider
    - [x] Complete profile setup flow: Name → Gender → Birthday → Height → Weight → Budget → Household Size → Medical Conditions → Firebase Save → BMI Calculator
 - [x] **User Dashboard**
   - [x] `user_dashboard_page.dart` (modern calorie overview, nutrient breakdown, daily meal plan, weekly progress)
   - [x] Navigation from BMI Calculator to Dashboard implemented
 - [x] **Profile Features**
   - [x] `user_profile_page.dart` (modern profile UI with CustomScrollView, SliverAppBar, gradient headers, interactive sections)
   - [x] Firebase integration implemented (loads and displays real user data)
   - [x] Real user stats: age, weight, height, household size, weekly budget
   - [x] Real health conditions display from Firebase
   - [x] `edit_profile_page.dart` Firebase integration implemented
   - [x] Email field made non-editable with visual indicator
   - [x] Save functionality connects to Firebase
   - [x] Loading states implemented for form loading and saving
   - [x] Form validation and error handling implemented
   - [x] Bottom Navigation Bar (6 tabs: Home, Profile, Price Monitoring, Meal Plan, Q&A Forum, Teleconsultation)
   - [x] Main Navigation Wrapper (combines all features with bottom navigation)
   - [x] Navigation overflow fixed (Expanded widgets, responsive text, shortened labels)
   - [x] Modern profile design implemented (gradient headers, elevated elements, smooth scrolling)
- [x] **Meal Planner Features**
  - [x] **FNRI-Based Meals Data Structure** (`lib/data/predefined_meals.dart`) implemented
    - [x] `PredefinedMeal` class with comprehensive nutrition and recipe data integrated from FNRI research
    - [x] `HealthConditions` class with binary flags for 8 health conditions (diabetes, hypertension, obesity, underweight, heart_disease, anemia, osteoporosis, none)
    - [x] `MealTiming` class for meal-specific suitability (breakfast, lunch, dinner, snack)
    - [x] `MealIngredient` class for detailed ingredient information
    - [x] `PredefinedMealsData` static class with 10+ FNRI research-based meals including:
      - [x] FNRI Filipino dishes: Adobong Manok, Sinigang na Hipon, Kare-Kareng Baka, Chicken Tinola, Pinakbet, Longsilog, Tapsilog
      - [x] FNRI Healthy options: Grilled Bangus, Monggo Soup, Steamed Rice with Vegetables
      - [x] All meals include health condition safety flags and medical suitability ratings
    - [x] Health-aware helper methods: `getMealsForHealthCondition()`, `getPersonalizedMeals()`, `searchMeals()`, `getMealsByTag()`, `getMealsByCalories()`, `getMealById()`, `getHealthyMeals()`
    - [x] PAX scaling functionality: `scaleRecipeForPax()` with dynamic ingredient and nutrition adjustment
    - [x] AI meal selection: `selectRandomMealsWithVariety()` with scoring algorithm for nutrition balance and health conditions
    - [x] Static data: recent searches list, rotating nutrition tips, health condition filtering
  - [x] **PersonalizedMealService** (`lib/services/personalized_meal_service.dart`) NEW IMPLEMENTATION
    - [x] AI-powered meal recommendation service with health condition awareness
    - [x] `generateDailyMealPlan()` - Complete daily planning with personalized meal suggestions for all meal types
    - [x] `generateMealTypeSuggestions()` - Targeted recommendations for specific meal times
    - [x] `_calculateMealScore()` - Multi-factor scoring algorithm considering:
      - [x] BMI-based nutrition scoring (high protein for underweight, balanced for normal, low calorie for overweight)
      - [x] Health condition safety flags (cross-references user medical conditions with meal safety profiles)
      - [x] Variety scoring to prevent meal repetition
      - [x] Budget considerations and preparation time factors
    - [x] Firebase user integration for personalized recommendations
    - [x] Health condition filtering with medical safety validation
  - [x] **Enhanced Meal Logging Service** (`lib/services/meal_logging_service.dart`) UPDATED
    - [x] Firebase integration with users.meal_plans subcollection (compliant with Firebase schema)
    - [x] PAX support: Enhanced `logMeal()` method with PAX scaling and nutrition adjustment
    - [x] `getTodaysMeals()` and `getMealsForDate()` for meal history retrieval with PAX data
    - [x] `deleteMeal()` and meal replacement functionality with scaled nutrition tracking
    - [x] Calorie calculation based on amount, measurement, and PAX adjustments
    - [x] Weekly meal summary with PAX-scaled nutrition calculations
    - [x] Health condition metadata logging for meal safety tracking
  - [x] **Enhanced Meal Plan Page** (`meal_plan_page.dart`) UPDATED WITH AI FEATURES
    - [x] Firebase integration for Today's Meals display (loads actual logged meals)
    - [x] Real-time meal status with "logged" vs "empty" states
    - [x] **AI Meal Suggestion System** - Replaced all refresh buttons with intelligent recommendations
      - [x] "Generate AI Meal Plan" button for complete daily meal planning
      - [x] Individual AI suggestion buttons for each meal type (breakfast, lunch, dinner, snack)
      - [x] Comprehensive dialog system with personalized meal recommendations
      - [x] Health condition-aware suggestions with medical safety validation
      - [x] PAX-aware meal suggestions with proper scaling for household size
    - [x] Meal action buttons (Add meal, View details, Replace meal)
    - [x] Modal bottom sheet with meal options (View Details, Replace, Remove)
    - [x] Search functionality with text input (integrated with FNRI meals)
    - [x] Recent searches section using FNRI predefined data
    - [x] Rotating nutrition tips from FNRI research data
    - [x] Loading states for Firebase data operations
  - [x] **Updated Meal Search Results Page** (`meal_search_results_page.dart`) UPDATED FOR FNRI
    - [x] `PredefinedMeal` object integration with FNRI health condition support
    - [x] Real-time search functionality with health-aware `_performSearch()` method
    - [x] Comprehensive meal cards with nutrition display and health condition indicators
    - [x] Proper navigation to `RecipeDetailPage` with FNRI meal objects
    - [x] Health condition filtering and safety badge display
    - [x] Recipe metadata display (calories, prep time, difficulty, servings, health suitability)
    - [x] Icon mapping for different meal categories with health indicators
  - [x] **Enhanced Recipe Detail Page** (`recipe_detail_page.dart`) UPDATED FOR FNRI
    - [x] `PredefinedMeal` object support with FNRI health condition data
    - [x] Real ingredient list display using `MealIngredient` objects with PAX scaling
    - [x] Complete recipe information from FNRI predefined meal data
    - [x] Health condition safety badges and medical suitability indicators
    - [x] Navigation to `NutritionFactsPage` with proper FNRI meal parameter passing
    - [x] All widget references updated with health-aware display components
  - [x] **Enhanced Nutrition Facts Page** (`nutrition_facts_page.dart`) UPDATED WITH PAX SELECTION
    - [x] `PredefinedMeal` object support with FNRI nutrition calculation and health condition validation
    - [x] **PAX Selection Feature** - Complete implementation for household meal planning
      - [x] PAX selector dropdown widget (1-10 people selection)
      - [x] Dynamic nutrition scaling based on selected PAX count
      - [x] Real-time ingredient quantity updates with PAX adjustments
      - [x] Scaled calorie and nutrient calculations (fat, carbs, protein) for multiple people
    - [x] **Enhanced Meal Type Selection Dialog** - Complete implementation
      - [x] Modal bottom sheet with meal type options (Breakfast, Lunch, Dinner, Snack)
      - [x] Visual icons and color coding for each meal type
      - [x] Firebase meal logging integration via enhanced `MealLoggingService`
      - [x] PAX data logging with scaled nutrition values
    - [x] Dynamic nutrition calculations based on FNRI meal data and PAX serving adjustments
    - [x] Health condition safety validation before meal logging
    - [x] Firebase meal logging with PAX metadata and scaled nutrition (success/error messages)
    - [x] Complete navigation flow back to meal plan dashboard with updated data
  - [x] **Complete FNRI Integration & AI User Flow Implementation**
    - [x] Meal Plan Page → AI Suggestions → Search Results → Recipe Details → Nutrition Facts (PAX Selection) → Meal Type Selection → Firebase Logging
    - [x] AI-powered meal recommendations with health condition filtering and PAX awareness
    - [x] Complete daily meal planning with personalized suggestions for all meal types
    - [x] Today's Meals integration with actual Firebase data including PAX and health metadata
    - [x] Meal replacement and removal functionality with health-aware suggestions
    - [x] Real-time UI updates after meal logging operations with PAX-scaled nutrition
    - [x] Error handling and user feedback throughout the FNRI-powered flow
    - [x] Health condition safety validation at every step of meal selection and logging
  - [x] **Enhanced Firebase Schema Compliance**
    - [x] Meal plans saved to `users/{userId}/meal_plans` subcollection with FNRI integration
    - [x] Core schema fields: `meal_date` (timestamp), `meal_type` (string), `kcal_min/max` (numbers), `recipe_id` (reference)
    - [x] FNRI enhancement fields: `pax` (number), `scaled_kcal` (number), `health_conditions` (map), `meal_timing` (map)
    - [x] Additional metadata: `logged_at`, `recipe_name`, `amount`, `measurement`, `original_kcal`
    - [x] Health condition safety metadata: `is_diabetes_safe`, `is_hypertension_safe`, `is_obesity_safe`, etc.
    - [x] PAX scaling metadata: `original_servings`, `scaled_servings`, `scaling_factor`
  - [x] Complete FNRI-powered navigation flow implemented (Meal Plan → AI Suggestions → Search Results → Recipe Detail → Nutrition Facts with PAX → Meal Logging)
  - [x] All meal planning pages updated to use FNRI research-based meals with health condition filtering
  - [x] AI-powered meal suggestions replace manual refresh functionality
  - [x] Health condition filtering by diabetes, hypertension, obesity, underweight, heart disease, anemia, osteoporosis
  - [x] PAX scaling functionality for household meal planning (1-10 people)
  - [x] Filtering by health, budget, ingredients functional via FNRI data helper methods
- [x] **Market Prices**
  - [x] Dashboard implemented (`market_price_dashboard.dart`)
    - [x] Green header with title and user avatar
    - [x] Recent prices section with price items showing PHP prefix
    - [x] Price alerts section with trending/stable indicators
    - [x] Price trends section with custom chart painter
    - [x] Integrated into navigation wrapper at index 2 (Price Monitoring tab)
  - [x] Price alerts & trends functional (sample data implementation)
- [x] **Q&A Forum**
  - [x] Forum page implemented (`qna_forum_page.dart`)
    - [x] Green header with search bar and "Saved" button
    - [x] "Ask question..." input section with user avatar
    - [x] Question cards with user info, question text, answer count, and save functionality
    - [x] Special badge for verified nutritionists
    - [x] Modal bottom sheet for posting new questions
    - [x] Sample data implementation (ready for Firebase integration)
    - [x] Integrated into navigation wrapper at index 4 (Q&A tab)
  - [x] **Q&A Answers Page** (`qna_answers_page.dart`)
    - [x] Question display at top (original question with user details)
    - [x] Answer cards with user info, answer text, and interaction buttons
    - [x] Like/unlike functionality for answers
    - [x] Report dialog for inappropriate content
    - [x] Fixed bottom input for posting new answers
    - [x] Reply functionality with user feedback
    - [x] Sample answers data with verified nutritionist badges
  - [x] **Complete Navigation Flow**
    - [x] Question cards in forum page are tappable
    - [x] Navigation from forum to answers page with question data
    - [x] Proper data passing between pages
    - [x] All UI interactions functional (save, like, reply, report)
- [x] **Teleconsultation**
  - [x] Consultation page implemented (`book_consultation_page.dart`)
    - [x] Green header with "Book Consultation" and "My Appointments" tabs
    - [x] Search bar for finding professionals
    - [x] Professional cards with profile info, specializations, schedules, and ratings
    - [x] Available/Busy status indicators for professionals
    - [x] Schedule time chips showing available appointment slots
    - [x] "Book now" buttons with navigation to schedule page
    - [x] My Appointments tab showing booked consultations
    - [x] Appointment cards with professional details, date/time, and status
    - [x] Empty state for when no appointments are booked
    - [x] Sample data implementation (ready for Firebase integration)
    - [x] Integrated into navigation wrapper at index 5 (Teleconsultation tab)
  - [x] **Book Consultation Schedule Page** (`book_consultation_schedule_page.dart`)
    - [x] Green header with back button and "Book Consultation" title
    - [x] Professional info card displaying selected professional details
    - [x] Date section with interactive calendar widget (June 2025 layout)
    - [x] Time dropdown selection with available time slots
    - [x] "What do you want to talk about?" text area for consultation topic
    - [x] "Book Appointment" button with confirmation flow
    - [x] Navigation from Book Consultation page when "Book now" is clicked
    - [x] Complete booking flow with success feedback
  - [x] **Booking Confirmation Page** (`booking_confirmation_page.dart`)
    - [x] Green background with success styling
    - [x] Success checkmark icon in circular container
    - [x] "Your appointment is booked!" confirmation message
    - [x] Professional info display (avatar, name, specialization)
    - [x] Appointment details (formatted date, time, reference number)
    - [x] Optional topic display if user entered consultation topic
    - [x] "Go to My Appointments" button with navigation
    - [x] Complete navigation flow from schedule page
    - [x] Auto-generated reference numbers for bookings
- [ ] **Admin Features**
  - [ ] User management pages (`manage_users_page.dart`)
  - [ ] Recipe management pages (`manage_recipes_page.dart`)
  - [ ] Price data validation pages
  - [ ] Forum moderation pages
  - [ ] Teleconsultation approval pages
- [ ] **Professional Features**
  - [ ] Consultation dashboard (`professional_consultation_page.dart`)
  - [ ] Profile management & availability
- [ ] **Core Integrations**
  - [ ] Firebase Firestore read/write verified
  - [ ] Authentication & role management working
  - [ ] Push notifications implemented
  - [ ] Offline support tested
- [ ] **UI/UX**
  - [ ] All pages responsive
  - [ ] Material Design applied consistently
  - [ ] Colors, fonts, buttons, and inputs standardized
- [ ] **Testing**
  - [ ] Unit tests completed for models/services
  - [ ] Widget tests completed for all pages
  - [ ] Integration tests completed for Firebase interactions

---

### Notes for Copilot
- Update `implementation_checklist.instructions.md` automatically after adding a new feature or page.
- Each new page or service added should include checklist items under the relevant section.
- Use consistent naming: `snake_case` for files, `PascalCase` for classes, `camelCase` for variables.
- Validate Firebase fields against the defined schema when creating/updating documents.
